<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transcriptomic Summary • Antler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Transcriptomic Summary">
<meta property="og:description" content="Antler">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Antler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Transcriptomic-summary.html">Transcriptomic Summary</a>
</li>
<li>
  <a href="../articles/Carving-cell-trajectories.html">Carving Cell Trajectories</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/juliendelile/Antler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Transcriptomic Summary</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/juliendelile/Antler/blob/master/vignettes/Transcriptomic-summary.Rmd"><code>vignettes/Transcriptomic-summary.Rmd</code></a></small>
      <div class="hidden name"><code>Transcriptomic-summary.Rmd</code></div>

    </div>

    
    
<style> img {border: 0px;outline: 0;padding: 10px;}</style>
<p>In this vignette, we will demonstrate how <strong>Antler</strong> can be used to identify, export and visualize the transcriptomic states of the cells present in a single-cell RNA-seq (<em>scRNA-seq</em>) dataset.</p>
<p align="center">
<img src="images/Transcriptome_summary_selection_I_hclust_selection_I_Normalized_logscaled.png" width="100%"></p>
<p align="center">
<i>Example of a transcriptomic summary produced in this vignette.</i>
</p>
<p><br></p>
<p>A typical <strong>Antler</strong> pipeline is data-driven and as unbiased as possible. It requires little knowledge about the biological context of the dataset. The workflow consists in the following steps:</p>
<ol style="list-style-type: decimal">
<li>Loading and preparing the dataset</li>
<li>Pre-processing
<ul>
<li>Removing outlier gene and cells</li>
<li>Normalizing gene expression levels</li>
</ul>
</li>
<li>Identifying gene modules</li>
<li>Defining cell transciptomic state</li>
<li>Visualizing</li>
<li>Redefining cell states with prior knowledge if needed</li>
</ol>
<p>Among these steps, the most important one is the gene module identification step which selects and groups all the genes defining the data-driven transcriptomic states.</p>
<p>In contrast with other scRNA-seq analysis methods, <strong>Antler</strong> performs a direct gene selection from the raw or normalized gene expression levels using correlation. It does not rely on preliminary linear or non-linear dimension reduction steps to retain the signal of interest. The main advantage is that the characterization the cell states is transparent, we known which genes contribute to the states definition.</p>
<p>Once the data-driven transcriptomic states are defined, the user has two options to refine this unbiased description and reveal the context-dependent cellular states:</p>
<ul>
<li><p>either selecting manually the modules containing known genes involved in the biological context and new candidate ones hence defining context-dependent transcriptomic states,</p></li>
<li><p>or taking advantage of the <code><a href="../reference/carve.html">carve()</a></code> function which select automatically the gene modules related to time-dependent differentiation and build graph-based trajectories (see) the “Carving cell trajectories” vignette).</p></li>
</ul>
<div id="creating-an-antler-object" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-an-antler-object" class="anchor"></a>Creating an Antler object</h2>
<p>After attaching the <strong>Antler</strong> package to the R session, we instanciate an single object which will contain both the data and all the functions provided by the package (a R “reference class”). The <code>output_folder</code> argument specifies the location of folder containing the different plot and reporting files generated during the analysis.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Antler</span>)</pre></body></html></div>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span> <span class="kw">&lt;-</span> <span class="no">Antler</span>$<span class="fu">new</span>(<span class="kw">output_folder</span><span class="kw">=</span><span class="st">"/tmp/demo_antler/"</span>)</pre></body></html></div>
<p>The functions are called using the name of the instanciated object (here <code>antler</code>) and the <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> operator. For example the dataset is loaded by calling the following function (see below): <code>antler$load_dataset()</code>.</p>
<p>The documentation of a function is accessed with the standard <code>help()</code> function and <code>?</code> help operator, and without writing the name of the instanciated object. To get the documentation of the <code>antler$load_dataset()</code> function, type <code><a href="../reference/load_dataset.html">?load_dataset</a></code>.</p>
</div>
<div id="loading-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-the-data" class="anchor"></a>Loading the data</h2>
<p>In this vignette, we will analyse a small dataset included in the package comprising 1025 cells dissected from the cervicothoracic region of developing mouse embryos. The full dataset can be retrieved by following these <a href="https://github.com/juliendelile/MouseSpinalCordAtlas#data-availability">external instructions</a>.</p>
<p>By default, the dataset folder must contain two tab-delimited csv files:</p>
<ul>
<li>A read count file named “assayData.csv” with cell names in the header and gene names as row names,</li>
<li>A meta-data file named “phenoData.csv” and populated with at least 3 fields: “timepoint” (floating values), “replicate_id” (integer values) and “treatment” (characters).</li>
</ul>
<p>Fo now we will locate and load the files provided by the package using the <code>system.file</code> function as the dataset folder path depends on the package installation path. In general, a simple character path is used.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/load_dataset.html">load_dataset</a></span>(
  <span class="kw">folder_path</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(
    <span class="st">"extdata"</span>,
    <span class="st">"mouse_spinal_cord"</span>,
    <span class="kw">package</span> <span class="kw">=</span> <span class="st">"Antler"</span>))</pre></body></html></div>
<p>Read counts and cell meta-data can also be specified with different file names (<code>phenoData_filename</code> and <code>assayData_filename</code> arguments) or directly from matrices (<code>assayData</code> and <code>phenoData</code>).</p>
<p><code><a href="../reference/num_cells.html">num_cells()</a></code> and <code><a href="../reference/num_genes.html">num_genes()</a></code> are the functions counting the number of cells and genes stored in the dataset.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/num_cells.html">num_cells</a></span>()
<span class="co">#&gt; [1] 1025</span></pre></body></html></div>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/num_genes.html">num_genes</a></span>()
<span class="co">#&gt; [1] 10008</span></pre></body></html></div>
</div>
<div id="preparing-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-the-data" class="anchor"></a>Preparing the data</h2>
<p>ScRNA-seq datasets are generally produced by sequencing platform identifying genes by their <em>ensembl</em> id. For conveniency, we replace these ids with the associated gene names by running the <code><a href="../reference/convert_ensembl_id_to_name.html">convert_ensembl_id_to_name()</a></code> function:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/convert_ensembl_id_to_name.html">convert_ensembl_id_to_name</a></span>(<span class="kw">biomart_dataset</span> <span class="kw">=</span> <span class="st">"mmusculus_gene_ensembl"</span>)</pre></body></html></div>
<p>The first 20 gene names can be viewed with:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/gene_names.html">gene_names</a></span>()[<span class="fl">1</span>:<span class="fl">20</span>]</pre></body></html></div>
<p>For reproducibility, speed or in absence of internet connection the ensembl id conversion can be processed from a local mapping csv file. A copy of the mouse and chick gene names is provided in the package. These files may need updating as names keep on getting created or redefined.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/convert_ensembl_id_to_name.html">convert_ensembl_id_to_name</a></span>(
    <span class="kw">biomart_dataset</span> <span class="kw">=</span> <span class="st">"mmusculus_gene_ensembl"</span>,
    <span class="kw">gene_ids_mapping_file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(
        <span class="st">"extdata"</span>,
        <span class="st">"Annotations/biomart_ensemblid_genename_mmusculus.csv"</span>,
    <span class="kw">package</span><span class="kw">=</span><span class="st">"Antler"</span>))</pre></body></html></div>
<p>Optionally, we may also want for aesthetic reasons to map specific colors to some cell or gene features. In the following, we will generate plots decorated by the cells’ <code>'timepoint'</code> and <code>'replicate_id'</code> features. These colors can be specified as the following:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/add_color_map.html">add_color_map</a></span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"timepoint"</span>,
  <span class="kw">content</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(
    <span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="fl">5</span>,<span class="st">"YlOrRd"</span>),
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"9.5"</span>, <span class="st">"10.5"</span>, <span class="st">"11.5"</span>, <span class="st">"12.5"</span>, <span class="st">"13.5"</span>)))

<span class="no">antler</span>$<span class="fu"><a href="../reference/add_color_map.html">add_color_map</a></span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"replicate_id"</span>,
  <span class="kw">content</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(
    <span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="fl">3</span>,<span class="st">"PuBu"</span>),
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>)))</pre></body></html></div>
<p>The list of loaded color maps can be accessed with <code>antler$color_maps</code>.</p>
</div>
<div id="pre-processing" class="section level2">
<h2 class="hasAnchor">
<a href="#pre-processing" class="anchor"></a>Pre-processing</h2>
<p><strong>Antler</strong> proposes a minimal set of pre-processing functions aiming at removing outlier genes and cells and normalizing the gene levels. We consider that more complex pre-processing such as identifying batch-dependent genes can be done with the gene module identification strategy that will be introduced in the next section.</p>
<div id="visualizing-gene-levels-and-cell-count-distributions" class="section level3">
<h3 class="hasAnchor">
<a href="#visualizing-gene-levels-and-cell-count-distributions" class="anchor"></a>Visualizing gene levels and cell count distributions</h3>
<p>To set filtering thresholds and exclude outlier cells and genes, it is recommended to first visualize the distributions of gene levels and cell counts with <code>antler$plot_QC()</code>. The following plotting function generates pdf files in the project output folder specified when creating the <code>antler</code> object.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/plot_QC.html">plot_QC</a></span>(
  <span class="kw">data_status</span> <span class="kw">=</span> <span class="st">"Raw"</span>,
  <span class="kw">feature_1</span>   <span class="kw">=</span> <span class="st">"timepoint"</span>,
  <span class="kw">reads_type</span>  <span class="kw">=</span> <span class="st">"UMI"</span>)</pre></body></html></div>
<p>The <code>antler</code> object stores up to three versions of the gene levels:</p>
<ul>
<li>the <code>"Raw"</code> level corresponding to the exported sequencing values. This is the default status for the loaded dataset.</li>
<li>the <code>"Normalized"</code> level corresponding to normalized values (see below).</li>
<li>the <code>"Smoothed"</code> level corresponding to imputed levels using the cell state graphs (see <a href="https://juliendelile.github.io/Antler/articles/Carving-cell-trajectories.html#imputing-gene-level-from-cell-state-graph-1">vignette</a>).</li>
</ul>
<p>In the previous function call, we specified <code>data_status = "Raw"</code> to use the raw gene level in the distribution plots.</p>
<p>The generated plots are slightly redundant in order to satisfy a wider range of user preferences.</p>
<p align="center">
<img src="images/expressed_genes_per_cell.png" width="20%"><img src="images/library_sizes.png" width="20%"><img src="images/library_sizes_I_by_timepoint.png" width="35%"></p>
<p align="center">
<img src="images/expressed_genes_count_by_timepoint.png" width="20%"><img src="images/library_sizes_II_by_timepoint.png" width="20%"><img src="images/cell_count_by_timepoint.png" width="35%"></p>
<p align="center">
<i>Plots generated by <code>antler$plot_QC()</code><br>(Note that the colors are taken from the <code>timepoint</code> color map specified above).</i>
</p>
<p><br></p>
<p>More advanced plots can also be generated by specifying another grouping feature via the <code>feature_2</code> argument (e.g. try <code>feature_2 = "replicate_id")</code>.</p>
</div>
<div id="remove-outlier-genes-and-cells" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-outlier-genes-and-cells" class="anchor"></a>Remove outlier genes and cells</h3>
<p>A cell will be excluded if it does not satisfy all the following 3 criteria:</p>
<ul>
<li>minimum total read (or UMI) counts (default to <code>-Inf</code>).</li>
<li>maximum total read (or UMI) counts (default to <code>Inf</code>).</li>
<li>minimum number of expressed genes (default to <code>1000</code>).</li>
</ul>
<p>A gene will be excluded if the number of cells it is expressed in is lower than a threshold value (default to <code>10</code>).</p>
<p>Upon inspection of the above expressed genes distribution, we will simply select cells having at list 500 UMIs instead of the default threshold of 10.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/remove_outliers.html">remove_outliers</a></span>(
    <span class="kw">min_genes</span> <span class="kw">=</span> <span class="fl">500</span>,
    <span class="kw">min_cells</span> <span class="kw">=</span> <span class="fl">20</span>)
<span class="co">#&gt; Pre-filtering (dataset dimension:10008 1025)</span>
<span class="co">#&gt; Filter I - select cells with at least -Inf reads (dataset dimension:10008 1025)</span>
<span class="co">#&gt; Filter II - select cells with less than Inf reads (dataset dimension:10008 1025)</span>
<span class="co">#&gt; Filter III - select genes expressed in at least 20 cells (dataset dimension:4096 1025)</span>
<span class="co">#&gt; Filter IV - select cells expressing at least 500 genes (dataset dimension:4096 994)</span></pre></body></html></div>
</div>
<div id="normalization" class="section level3">
<h3 class="hasAnchor">
<a href="#normalization" class="anchor"></a>Normalization</h3>
<p>Three methods are implemented to normalize the raw gene expression level:</p>
<ul>
<li><p><code>'CPM'</code> or <code>'Count-Per-Million'</code>: the raw gene expression levels are divided by the total read count of the cell and multiplied by 1e6. This method corrects for sequencing depth.</p></li>
<li><p>‘FPKM’: the CPM levels are divided by the gene length in kilobase. This method corrects for sequencing depth and gene length.</p></li>
<li><p><code>MR</code> or <code>'Median-of-ratios'</code>: the raw gene expression levels are divided by cell size factors equals to the median ratio of gene counts relative to geometric mean per gene. This method corrects for library size and RNA composition bias and is a reimplementation of DESeq2’ <a href="https://rdrr.io/bioc/DESeq2/man/estimateSizeFactors.html"><code>estimateSizeFactors()</code></a> with the “poscounts” estimator which deals with genes with some zeros.</p></li>
</ul>
<p>We will now use the latter method.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/normalize.html">normalize</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">'MR'</span>)</pre></body></html></div>
</div>
<div id="gene-selection-from-dispersion" class="section level3">
<h3 class="hasAnchor">
<a href="#gene-selection-from-dispersion" class="anchor"></a>Gene selection from dispersion</h3>
<p>Because the cell states will be characterized by genes showing variable expression in the dataset and to reduce the computational workload of the pipeline, it is suggested that another preliminary gene-filtering step is applied. We use the measure of dispersion by bins introduced in <a href="https://dx.doi.org/10.1038%2Fnbt.3192">Satija et al. 2015</a> and implemented in the <a href="https://rdrr.io/cran/Seurat/man/FindVariableFeatures.html">Seurat</a> package to select genes having a sufficient (z-)score.</p>
<p>Here the dispersion (z-)scores are calculated on the normalized expression levels, as specified by the <code>data_status</code> argument.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/select_dispersed_genes.html">select_dispersed_genes</a></span>(
    <span class="kw">zscore_threshold</span> <span class="kw">=</span> -<span class="fl">.5</span>,
    <span class="kw">data_status</span>      <span class="kw">=</span> <span class="st">"Normalized"</span>)</pre></body></html></div>
</div>
</div>
<div id="gene-modules-identification" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-modules-identification" class="anchor"></a>Gene Modules Identification</h2>
<p>One of the most useful methods in <strong>Antler</strong> is the gene module identification step which clusters genes demonstrating concerted patterns of expression using correlation.</p>
<p>The gene modules reveal all the transcriptomic features in the cell population of the dataset. This list is unbiased and is often too exhaustive to characterize a specific biological question. We obtain gene modules highlighting features related to cell cycle, metabolism or even set of genes related to the way the samples are produced (batch effect). We will see in a section <a href="#redefining-cell-states-with-prior-knowledge">further below</a> how to restrict the gene modules to a specific context.</p>
<p>At its core, gene module identification is an iterative method which defines gene modules by clustering and applies a set of quality control filters to each of the modules. Iteration stops when all the gene modules satisfy the filtering criteria. The associated function is <code>antler$gene_modules$identify()</code>.</p>
<p align="center">
<img src="images_ext/gene_module_identification.png" width="90%"></p>
<p align="center">
<i>Intermediate and final iterations of the gene module identification method. A. Among the 5 gene modules identified, 2 do not satisfy some quality control criteria (see below). These genes are excluded and the remaining ones are re-clustered until B. all gene modules are compliant.</i>
</p>
<p><br></p>
<p>Prior to the iterative loop, the genes showing highest Spearman correlation with a least <code>corr_min</code> other genes are selected. Either a minimal correlation threshold (<code>corr_t</code>) or a target number of genes to select (‘corr_num_genes’) must be specified. Using Spearman correlation offers two advantages: it does not require specific types of distribution for each pair of genes and is robust to outliers.</p>
<p>Once the first set of genes have been selected, the iterative process is triggered with each loop starting by grouping the genes into modules using a hierarchical clustering algorithm. For the same reasons as above, we work with the Spearman correlation as a measure of gene dissimilarity. By default, a heuristic method is used to determine the optimal number of modules.</p>
<p align="center">
<img src="images/Gene_module_identification_unbiasedGMs_heuristic_loop_0.png" width="70%"></p>
<p align="center">
<i>Heuristic method selecting an “optimal” number of gene modules (or “clusters” in figure). Module distortions (sum of squared differences between a gene and its module average) are calculated for different number of modules: 1, 11, 21, .., 91, 100, 200, …, 700 and 757, the number of remaining genes (black dots). The method defines the position of the “elbow” of the curve as the point minimizing the area of the orange polygon (red dot).</i>
</p>
<p><br></p>
<p>This heuristic can be overriden by giving a specific target number with the <code>num_final_gms</code> argument.</p>
<p>We then employ a set of 5 criteria aiming at discarding any modules comprising genes showing more noise than signal:</p>
<ol style="list-style-type: decimal">
<li><p>A first filtering criterion is applied to test whether enough cells are expressing the genes that comprise the gene module. For each cell, we obtain an average expression level per module by averaging the z-scored log-transformed normalized expression levels of all genes that belong to the module. These gene module averaged levels are then binarised independently using a parameter-free adaptive thresholding method. A cell is considered to “express” a gene module if the associated Boolean value is true. Modules expressed in fewer than <code>mod_min_cell</code> cells are excluded (default to <code>0</code>). A maximum number of cells expressing a gene module can also be specified (<code>mod_max_cell</code> which defaults to <code>Inf</code>).</p></li>
<li><p>A second filtering criterion is applied to test whether cells are expressing the gene module with consistently high levels over most of the genes in the module. We once again binarise the z-scored log-transformed normalized expression levels of all the remaining genes independently. Then, for each module, we calculate the ratio of Boolean values in cells that expressed the module (as defined in 1). We exclude modules in which less than <code>mod_consistency_thres</code> of these Boolean values were true (default to <code>0.4</code>).</p></li>
<li><p>A third filtering criterion is a variation of the second one where the average expression level in cells expressing the module must be higher than a minimum threshold <code>min_cell_level</code> (default to <code>0</code>).</p></li>
<li><p>A fourth filtering criterion is applied to test whether genes are expressed only in a subset of the cells. We select modules having an average level skewness higher than <code>mod_skewness_thres</code> (default to <code>-Inf</code>).</p></li>
<li><p>Optionally, a fifth filtering criterion can be applied to select modules demonstrating a sufficient correlation with an external cell metadata (e.g. the sample time point or a combination of specific genes).</p></li>
</ol>
<p>In most use cases, as in this vignette, only the first two criteria are needed.</p>
<p>Importantly this method requires that the gene levels have been normalized before being run so it will throw an error if it has not been done.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">gene_modules</span>$<span class="fu"><a href="https://rdrr.io/r/graphics/identify.html">identify</a></span>(
    <span class="kw">name</span>                  <span class="kw">=</span> <span class="st">"unbiasedGMs"</span>,
    <span class="kw">corr_t</span>                <span class="kw">=</span> <span class="fl">0.3</span>,  <span class="co"># the Spearman correlation treshold</span>
    <span class="kw">corr_min</span>              <span class="kw">=</span> <span class="fl">3</span>,    <span class="co"># min. number of genes a gene must correlate with</span>
    <span class="kw">mod_min_cell</span>          <span class="kw">=</span> <span class="fl">10</span>,   <span class="co"># min. number of cells expressing the module</span>
    <span class="kw">mod_consistency_thres</span> <span class="kw">=</span> <span class="fl">0.3</span>,  <span class="co"># ratio of expressed genes among "positive" cells</span>
    <span class="kw">process_plots</span>         <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="co"># plot optimal module number heuristics</span></pre></body></html></div>
<p>Multiple set of gene modules can be identified under different settings so each time a different <code>name</code> argument must be specified. The set of curently available lists of gene modules is obtained with:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">gene_modules</span>$<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>()
<span class="co">#&gt; [1] "unbiasedGMs"</span></pre></body></html></div>
<p>A specific set of gene modules can be printed with:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">gene_modules</span>$<span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="st">"unbiasedGMs"</span>)</pre></body></html></div>
<p>Users can also provide their own gene modules manually, given that the gene names are present in the dataset (see <code>antler$gene_names()</code> to retrieve the list):</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">gene_modules</span>$<span class="fu">set</span>(
  <span class="kw">name</span>    <span class="kw">=</span> <span class="st">"manual"</span>,
  <span class="kw">content</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Tubb3"</span>, <span class="st">"Sox21"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Lhx1"</span>, <span class="st">"Sox1"</span>)))</pre></body></html></div>
<p>It must be noted that the syntax of this function call is slightly different from the previous ones and involves two <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> symbols. This is because the <code>gene_modules</code> field of <code>antler</code> is itself a reference class having its own <code><a href="https://rdrr.io/r/graphics/identify.html">identify()</a></code> function. A downside is that the function documentation is accessed with a slightly different pattern: <code><a href="../reference/gene_modules_identify.html">?gene_modules_identify</a></code> for example.</p>
</div>
<div id="unbiased-and-comprehensive-transcriptomic-states" class="section level2">
<h2 class="hasAnchor">
<a href="#unbiased-and-comprehensive-transcriptomic-states" class="anchor"></a>Unbiased and Comprehensive Transcriptomic States</h2>
<p>In this section we aim at defining the comprehensive set of unbiased transcriptomic cell states. These states are “unbiased” because no prior biological knowledge is needed to define them and “comprehensive” because all the transcriptomic features identified above will be used. Later below, we will see how to subset the gene modules using prior knowledge.</p>
<p>The process of defining the transcriptomic states presents two challenges inherent to clustering problems:</p>
<ol style="list-style-type: decimal">
<li>what clustering algorithm should be used?</li>
<li>how many states or clusters coexist in the dataset?</li>
</ol>
<p>Once again, we utilize a hierarchical clustering algorithm, mainly for the sake of visualization. Indeed, once the cell states have been defined, the recommended next step is to visualize them as a heatmap (see next section). In contrast to most clustering algorithm, hierarchical clustering orders all the cells independently from the number of clusters. This allow us to visually evaluate the need to increase or decrease the number of identified states by observing whether some states could be divided further.</p>
<p>Without specifying a target number of clusters with the <code>num_clusters</code> argument, the <code>antler$cell_clusters$identify()</code> function determines an optimal number of clusters with a second heuristic method. Similarly to the gene module heuristic method, the cell cluster one also aims at defining the position of the elbow of the distortion curve but it predicts an optimal number which tends to be lower.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">cell_clusters</span>$<span class="fu"><a href="https://rdrr.io/r/graphics/identify.html">identify</a></span>(
  <span class="kw">name</span>              <span class="kw">=</span> <span class="st">"hclust"</span>,
  <span class="kw">gene_modules_name</span> <span class="kw">=</span> <span class="st">"unbiasedGMs"</span>,
  <span class="co"># num_clusters      = 20, # uncomment to obtain 20 clusters</span>
  <span class="kw">process_plots</span>     <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>With the current dataset we obtain 25 cell states with the heuristic method.</p>
<p align="center">
<img src="images/Cell_clustering_heuristic_hclust.png" width="70%"></p>
<p align="center">
<i>Heuristic method selecting an “optimal” number of cell clusters.</i>
</p>
<br><p align="center">
<i>Heuristic method selecting an “optimal” number of cell clusters. The method estimates the position of the “elbow” of the curve by fitting a piecewise linear function to the distortion curve. The fitted function is anchored on the two distortion curve extrema and the position of the central endpoint is optimized by least-square regression. The absissa of that point is the estimated number of clusters.</i>
</p>
<p><br></p>
</div>
<div id="visualizing-the-comprehensive-summary-of-the-transcriptomic-states" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-the-comprehensive-summary-of-the-transcriptomic-states" class="anchor"></a>Visualizing the comprehensive summary of the transcriptomic states</h2>
<p>The primary objective of this vignette is to produce a single plot highligthing all the important transcriptomic features of a scRNA-seq dataset. This plot is generated by the <code>antler$plot_transcriptome_summary()</code> function. It consists in a usually large heatmap showing all the selected genes horizontally and the cell clusters vertically. Among other advantages, a careful inspection of the transcriptomic summary heatmap facilitates:</p>
<ul>
<li>the discovery of new candidate genes,</li>
<li>the evaluation of the sizes of the different cell states,</li>
<li>the selection of specific cell populations for further analysis.</li>
</ul>
<p>Before calling the plotting function, we are taking advantage of the <code><a href="../reference/genes_from_GOterms.html">genes_from_GOterms()</a></code> function to build a list of domain-relevant genes from a list of <a href="http://geneontology.org/docs/ontology-documentation/">GO terms</a>. While it is possible not to, it is advised to restrict the set of displayed gene names in the plot for clarity. This is especially true if the gene modules comprise a large number of genes (here a reasonable total of 757 genes). The current dataset being mostly made of neural cells in a forming spinal chord, we use the following GO terms to build our list of gene names:</p>
<ul>
<li>
<code>GO:0007399</code> for genes associated with nervous system development,</li>
<li>
<code>GO:0030154</code> for genes associated with cell differentiation,</li>
<li>
<code>GO:0016477</code> for genes associated with cell migration.</li>
</ul>
<div class="sourceCode"><html><body><pre class="r"><span class="no">gene_list</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/genes_from_GOterms.html">genes_from_GOterms</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'GO:0007399'</span>, <span class="st">'GO:0030154'</span>, <span class="st">'GO:0016477'</span>))</pre></body></html></div>
<p>We finally call the <code>antler$plot_transcriptome_summary()</code> plotting function. Here will generate a single pdf file in the project <code>output_folder</code> directory but more files can be generated at once by uncommenting the commented lines.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/plot_transcriptome_summary.html">plot_transcriptome_summary</a></span>(
  <span class="kw">gene_modules_name</span>  <span class="kw">=</span> <span class="st">"unbiasedGMs"</span>, <span class="co"># name of the set of gene modules</span>
  <span class="kw">cell_clusters_name</span> <span class="kw">=</span> <span class="st">"hclust"</span>,      <span class="co"># name of the cell clusters as defined above</span>
  <span class="kw">cell_side_colors</span>   <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'timepoint'</span>, <span class="st">'replicate_id'</span>, <span class="st">'hclust'</span>),
  <span class="kw">data_status</span>        <span class="kw">=</span> <span class="st">"Normalized"</span>,
  <span class="kw">gene_level_func</span>    <span class="kw">=</span> <span class="st">"logscaled"</span>,
  <span class="kw">file_settings</span>      <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">type</span><span class="kw">=</span><span class="st">'pdf'</span>, <span class="kw">width</span><span class="kw">=</span><span class="fl">12</span>, <span class="kw">height</span><span class="kw">=</span><span class="fl">8</span>)
    <span class="co"># , list(type='cairo_pdf', width=12, height=8) # better choice for large heatmaps</span>
    <span class="co"># , list(type='png', width=2400, height=1600, res = 200) # png output</span>
    ),
  <span class="kw">fontsize</span>           <span class="kw">=</span> <span class="fl">6</span>,
  <span class="kw">color_limit_value</span>  <span class="kw">=</span> <span class="fl">2.0</span>,
  <span class="kw">gene_labels_filter</span> <span class="kw">=</span> <span class="no">gene_list</span>)</pre></body></html></div>
<p>The resulting heatmap looks as the following:</p>
<p align="center">
<img src="images/Transcriptome_summary_unbiasedGMs_hclust_Normalized_logscaled.png" width="100%"></p>
<p align="center">
<i>Heatmap of the comprehensive transcriptomic summary of the dataset.</i>
</p>
<p><br></p>
<p>If the above pipeline is run on the whole 40k+ cells dataset, the transcriptomic summary heatmap reveals the variety of transcriptomic features and cell populations to a much greater extend.</p>
<p align="center">
<img src="images_ext/Transcriptome_summary_unbiasedGMs_hclust_Normalized_logscaled.cairo.png" width="100%"></p>
<p align="center">
<i>Heatmap of the comprehensive transcriptomic summary of the full 40k+ cells dataset.</i>
</p>
<p><br></p>
<div id="plotting-tips" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-tips" class="anchor"></a>Plotting tips</h3>
<p>The heatmap is easier to read when maximized fullscreen on a monitor. A few parameters can be tuned to improve the final appearance of the plot: the width, height and resolution (png files only) are controlled by <code>file_settings</code>, the number of printed genes per line is controlled by <code>num_gene_per_line</code> (defaults to 8), the base font size by <code>fontsize</code> (defaults to 10), the range of the expression level color map by <code>color_limit_value</code> (defaults to 2 for z-normalized log-transformed levels as specified above). More arguments of the underlying plotting function <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap::pheatmap()</a></code> can also be tuned such as <code>treeheight_col</code> setting the height of the dendrogram, <code>cellheight</code> for each individual matrix element height,<code>legend</code> to show the legend, <code>annotation_legend</code> to show the annotation legend… etc. (see <code>?pheatmap</code> for more information).</p>
</div>
<div id="large-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#large-dataset" class="anchor"></a>Large dataset</h3>
<p>For large datasets (i.e. between ~10k and ~100k cells), the only plotting backend producing consistent outputs is <code>cairo_pdf</code>. It generates a normal text-searchable pdf file replacing vector-based graphics with bitmaps (sometimes). If the output pdf file is too large to be opened with a standard pdf viewer, one option is to convert it to a png file manually, for example using <a href="https://imagemagick.org/index.php">ImageMagick</a> (see the <code>pdf_to_png()</code> function in this vignette’s source).</p>
<p>For very large dataset (i.e. with 100k+ cells), the most challenging step of the pipeline will be the cell clustering one which relies on a square dissimilarity matrix with as many row as cells. If that hurdle is passed over, the transcriptomic summary plots can be generated with only a subset of the cells by using the <code>subsampling_ratio</code> and <code>subsampling_min_cells</code> arguments.</p>
</div>
</div>
<div id="redefining-cell-states-with-prior-knowledge" class="section level2">
<h2 class="hasAnchor">
<a href="#redefining-cell-states-with-prior-knowledge" class="anchor"></a>Redefining cell states with prior knowledge</h2>
<p>While the comprehensive transcriptomic summaries offer a complete representation of the cell states at the RNA level, a typical biological study is primarily interested in a subset of the transcriptomic features: those containing genes that have already been characterized.</p>
<p>Selecting the features of interest can be achieved in two ways:</p>
<ul>
<li>by specifying the indices of the selected gene modules,</li>
</ul>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">gene_modules</span>$<span class="fu">select_from_ids</span>(
  <span class="kw">name_to</span>   <span class="kw">=</span> <span class="st">"selection_I"</span>,
  <span class="kw">name_from</span> <span class="kw">=</span> <span class="st">"unbiasedGMs"</span>,
  <span class="kw">ids</span>       <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">15</span>:<span class="fl">21</span>, <span class="fl">23</span>:<span class="fl">24</span>))</pre></body></html></div>
<ul>
<li>by extracting the gene module containing a list of target gene names.</li>
</ul>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">gene_modules</span>$<span class="fu">select_from_gene_names</span>(
  <span class="kw">name_to</span>    <span class="kw">=</span> <span class="st">"selection_II"</span>,
  <span class="kw">name_from</span>  <span class="kw">=</span> <span class="st">"unbiasedGMs"</span>,
  <span class="kw">gene_names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Tubb3"</span>, <span class="st">"Lhx1"</span>, <span class="st">"Wnt6"</span>, <span class="st">"Sox1"</span>, <span class="st">"Sox21"</span>))</pre></body></html></div>
<p>These two methods can be combined sequentially.</p>
<p>The characterization of the transcriptomic cell states is subjected to the selection of gene modules. The comprehensive and unbiased transcriptomic summary is often too dense to be practical and includes factors which are independent from the question of interest. By chosing to ignore some transcriptomic features and favor others, we are able to redefine the cell states, guided by existing biological knowledge.</p>
<p>We calculate and visualize this new set of cell clusters using the same function as previously.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">cell_clusters</span>$<span class="fu"><a href="https://rdrr.io/r/graphics/identify.html">identify</a></span>(
  <span class="kw">name</span>              <span class="kw">=</span> <span class="st">"hclust_selection_I"</span>,
  <span class="kw">gene_modules_name</span> <span class="kw">=</span> <span class="st">"selection_I"</span>,
  <span class="kw">num_clusters</span>      <span class="kw">=</span> <span class="fl">20</span>)

<span class="no">antler</span>$<span class="fu"><a href="../reference/plot_transcriptome_summary.html">plot_transcriptome_summary</a></span>(
  <span class="kw">gene_modules_name</span>  <span class="kw">=</span> <span class="st">"selection_I"</span>,
  <span class="kw">cell_clusters_name</span> <span class="kw">=</span> <span class="st">"hclust_selection_I"</span>,
  <span class="kw">cell_side_colors</span>   <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'timepoint'</span>, <span class="st">'replicate_id'</span>, <span class="st">'hclust_selection_I'</span>),
  <span class="kw">cell_side_colors_hide_legend</span> <span class="kw">=</span> <span class="st">"hclust_selection_I"</span>,
  <span class="kw">data_status</span>        <span class="kw">=</span> <span class="st">"Normalized"</span>,
  <span class="kw">gene_level_func</span>    <span class="kw">=</span> <span class="st">"logscaled"</span>,
  <span class="kw">file_settings</span>      <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">type</span><span class="kw">=</span><span class="st">'pdf'</span>, <span class="kw">width</span><span class="kw">=</span><span class="fl">12</span>, <span class="kw">height</span><span class="kw">=</span><span class="fl">7</span>)),
  <span class="kw">color_limit_value</span>  <span class="kw">=</span> <span class="fl">2.0</span>,
  <span class="kw">gene_labels_filter</span> <span class="kw">=</span> <span class="no">gene_list</span>)</pre></body></html></div>
<p align="center">
<img src="images/Transcriptome_summary_selection_I_hclust_selection_I_Normalized_logscaled.png" width="100%"></p>
<p align="center">
<i>Heatmap of a transcriptomic summary guided by prior knowledge.</i>
</p>
<p><br></p>
</div>
<div id="dissecting-cell-population-in-silico" class="section level2">
<h2 class="hasAnchor">
<a href="#dissecting-cell-population-in-silico" class="anchor"></a>Dissecting cell population <em>in silico</em>
</h2>
<p>Dissecting tissues <em>in vivo</em> or selecting for specific cell population <em>in vitro</em> often lead to the contamination of the samples with unsought cells. The advent of large scale datasets alleviates this concern and allow the <em>in silico</em> dissection of the dataset.</p>
<p>There are two ways to remove cells from an <strong>Antler</strong> pipeline:</p>
<ul>
<li>by specifying the excluded cell ids,</li>
</ul>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/remove_cells.html">remove_cells</a></span>(<span class="kw">ids</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">100</span>)) <span class="co"># remove the first 100 cells</span></pre></body></html></div>
<ul>
<li>and more conveniently by specifying the index of a cell cluster.</li>
</ul>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/remove_clusters.html">remove_clusters</a></span>(
  <span class="kw">cell_clusters_name</span> <span class="kw">=</span> <span class="st">"hclust_selection_I"</span>,
  <span class="kw">ids</span>                <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">6</span>)) <span class="co"># remove clusters #1 and #6</span></pre></body></html></div>
<p>This operation is definitive, cells can not be recovered after being excluded. It is sometimes convenient to make of copy of the <code>antler</code> object and work of the copy to keep the original object intact:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler_subset</span> <span class="kw">&lt;-</span> <span class="no">antler</span>$<span class="fu">copy</span>()
<span class="no">antler_subset</span>$<span class="fu"><a href="../reference/remove_cells.html">remove_cells</a></span>(<span class="kw">ids</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">100</span>))</pre></body></html></div>
<p>Once a set of cells are excluded, it is recommended to re-run the pipeline on the subsetted object. New gene modules will be different as the correlation won’t be calculated on the excluded cells and new cell clusters should be deduced.</p>
</div>
<div id="exploring-the-gene-modules" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-the-gene-modules" class="anchor"></a>Exploring the gene modules</h2>
<p>When a set of genes is expected to come up in the identified gene modules, it can be cumbersome to go through lists with hundreds of genes. We provide a function to facilitate this process.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">gene_modules</span>$<span class="fu">report_genes</span>(
  <span class="kw">name</span>       <span class="kw">=</span> <span class="st">"unbiasedGMs"</span>,
  <span class="kw">gene_names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"fake_gene"</span>, <span class="st">"Ass1"</span>, <span class="st">"Lhx1"</span>, <span class="st">"Wnt6"</span>, <span class="st">"Sox1"</span>, <span class="st">"Sox21"</span>))
<span class="co">#&gt; $`5`</span>
<span class="co">#&gt; [1] "Lhx1"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`16`</span>
<span class="co">#&gt; [1] "Wnt6"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`23`</span>
<span class="co">#&gt; [1] "Sox1"  "Sox21"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`not in modules`</span>
<span class="co">#&gt; [1] "Ass1"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`not in dataset`</span>
<span class="co">#&gt; [1] "fake_gene"</span></pre></body></html></div>
</div>
<div id="exporting" class="section level2">
<h2 class="hasAnchor">
<a href="#exporting" class="anchor"></a>Exporting</h2>
<p>As an <strong>Antler</strong> project is contained in a single object, it is easy to save it for later use…</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(<span class="no">antler</span>, <span class="kw">file</span> <span class="kw">=</span> <span class="st">"/tmp/antler.rds"</span>)</pre></body></html></div>
<p>…and to load it in a fresh session.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Antler</span>)
<span class="no">antler</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw">file</span> <span class="kw">=</span> <span class="st">"/tmp/antler.rds"</span>)</pre></body></html></div>
<p>Different options are available to export parts of a project:</p>
<ul>
<li>Exporting a gene module to a text file:</li>
</ul>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="no">gene_modules</span>$<span class="fu">export</span>(<span class="st">"unbiasedGMs"</span>)</pre></body></html></div>
<ul>
<li>Exporting the gene expression matrix and the cell metadatas (including the cluster indices):</li>
</ul>
<div class="sourceCode"><html><body><pre class="r"><span class="no">antler</span>$<span class="fu"><a href="../reference/save_dataset.html">save_dataset</a></span>(
  <span class="kw">folder_path</span> <span class="kw">=</span> <span class="st">"/tmp/exported_dataset/"</span>,
  <span class="kw">data_status</span> <span class="kw">=</span> <span class="st">"Raw"</span>)</pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Julien Delile.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
